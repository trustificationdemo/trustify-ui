import type React from "react";

import { Skeleton } from "@patternfly/react-core";

import { LoadingWrapper } from "@app/components/LoadingWrapper";
import { TableCellError } from "@app/components/TableCellError";
import { useSbomsOfVulnerability } from "@app/hooks/domain-controls/useSbomsOfVulnerability";

interface SbomsCountProps {
  vulnerabilityId: string;
}

export const SbomsCount: React.FC<SbomsCountProps> = ({ vulnerabilityId }) => {
  const { data, isFetching, fetchError } =
    useSbomsOfVulnerability(vulnerabilityId);

  return (
    <LoadingWrapper
      isFetching={isFetching}
      fetchError={fetchError}
      isFetchingState={<Skeleton screenreaderText="Loading contents" />}
      fetchErrorState={(error) => <TableCellError error={error} />}
    >
      {data.summary.sbomStatus.affected}
    </LoadingWrapper>
  );
};
